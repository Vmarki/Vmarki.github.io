<!DOCTYPE html><html><head>  <meta charset="utf-8">  <script src="http://d3js.org/d3.v3.min.js"></script>    <style> svg-container {     display: inline-block;     position: relative;     margin: auto;         width: 50%;          overflow: hidden; } svg-content {     display: inline-block;     position: absolute;     top: 0;     left: 0; } body {    font: 10px sans-serif; } h1{  font: 20px sans-serif;  font-weight: bold;  color:darkblue;  text-align:center;   }  h3{  font: 16px sans-serif;  font-weight: bold;  color:darkblue;  text-align:center;   } h4{  font: 14px sans-serif;  font-weight: normal;  color:darkblue;  text-align:center; }  </style>    <script type="text/javascript">      var margin = 200,
 width = 1800 - margin, height = 900 - margin;
 var vis = d3.select("body").append("svg")      .attr("width", width)      .attr("height", height);          //x start position by passenger class     var adult_shape_size = 9.5, child_shape_size = 5, adult_offset = 0, child_offset = 2.5, shape_size = 10;     var number_in_a_row = 22;     var x_start1 = margin, x_start2 = x_start1 + shape_size*number_in_a_row + margin/2,       x_start3 = x_start2 + shape_size*number_in_a_row + margin/2;     var y_start = 220 //y start position for original data state          var count1 = 0, count2 = 0, count3 = 0; //count of passengers by class     var count_y1 = 0, count_y2 = 0, count_y3 = 0; //count of passengers by class     var rows1 = 0, rows2 = 0, rows3 = 0;     var count1_p = 0, count2_p = 0, count3_p = 0; //count of passengers by class     var count_y1_p = 0, count_y2_p = 0, count_y3_p = 0; //count of perished passengers by class     var rows1_p = 0, rows2_p = 0, rows3_p = 0;     var leg_x = x_start1-margin*1.2, leg_y = 90, leg_row_height = 20;          function get_row_number(data,count){      var row_num = 0;      var rows = 0, rem = 0;      rows = count/number_in_a_row;      row_num = Math.floor(rows);      window.alert("row_num: "+row_num);      return row_num;     };
     function get_y(data, row, update=false){      var y = y_start;            //if (data["Survived"]==0 && update){      // window.alert("data[Survived] "+ data["Survived"] + " count_y1 " +count_y1+ " row " + row + " id " +       // data["PassengerId"] + " class " + data["Pclass"] + " age " +data["age"] + " Sex: " + data["Sex"]  );      //}            if(update && data["Survived"]==0){       //drow below divider line                 y = y_start + shape_size*(row-1);      }else{       y = y_start - shape_size*row;      }      if(data["Age"]<18){       y = y + child_offset;      }      //if (data["Survived"]==0 && update){      // window.alert( "row " + row + " id " + data["PassengerId"] + " class " + data["Pclass"] +  " y " + y );      //}      return y;     };          function get_x(data, count, start, update = false){      var x=start;    //if (data["Survived"]==0 && update){      // window.alert("start " + start + " Survived " + data["Survived"] + "count" + count + " class " + data["Pclass"] +       // " age " +data["age"] + " Sex: " + data["Sex"] );      //}            if (count == 0 || (count > 1 && count%number_in_a_row==0)){       x = start;      }else if(count%number_in_a_row == 0){       x = start + shape_size*(number_in_a_row-1);      }else{       x = start + shape_size*((count%number_in_a_row));      }      if(data["Age"]<18){       x = x + child_offset;      }      //if (data["Survived"]==0 && update){      // window.alert("data[Survived] "+ data["Survived"]  + " id " + data["PassengerId"] + "count" + count +       // " class " + data["Pclass"] + " age " +data["age"] + " Sex: " + data["Sex"] + " x " + x );      //}      return x;     };

        function draw(data) {          //debugger;      "use strict";   //make resizable svg     var svg = d3.select("div#container")      .append("svg")      .attr("preserveAspectRatio", "xMinYMin meet")      .attr("viewBox", "-165 -100 1300 500")      .classed("svg-content", true);                         //add description       var desc_x = -160, desc_y = -90;     svg    .append("text")    .attr("x", desc_x)                 .attr("y",desc_y)    .attr("text-anchor", "left")      .style("font-size", "12px")     .text("This visualization includes partial list of");       svg     .append("text")    .attr("x", desc_x)                 .attr("y",desc_y + leg_row_height)    .attr("text-anchor", "left")      .style("font-size", "12px")     .text("891 from total 1317 passengers travelled on Titanic.");       svg    .append("text")    .attr("x", desc_x)                 .attr("y",desc_y + 2*leg_row_height)    .attr("text-anchor", "left")      .style("font-size", "12px")     .text("Only 500 total passengers survived.");        svg    .append("text")    .attr("x", desc_x)                 .attr("y",desc_y + 3*leg_row_height)    .attr("text-anchor", "left")      .style("font-size", "12px")     .text("The method of data collection is not known");            svg    .append("text")    .attr("x", desc_x)                 .attr("y",desc_y + 4*leg_row_height)    .attr("text-anchor", "left")      .style("font-size", "12px")     .text(" and could be bias. However, these data still ");        svg    .append("text")    .attr("x", desc_x)                 .attr("y",desc_y + 5*leg_row_height)    .attr("text-anchor", "left")      .style("font-size", "12px")     .text("give a fair approximation of travel class and");         svg    .append("text")    .attr("x", desc_x)                 .attr("y",desc_y + 6*leg_row_height)    .attr("text-anchor", "left")      .style("font-size", "12px")     .text("gender having high impact on survival.");         svg    .append("text")    .attr("x", desc_x)                 .attr("y",desc_y + 7*leg_row_height)    .attr("text-anchor", "left")      .style("font-size", "12px")     .text("Survived passengers shown with full color ");              svg    .append("text")    .attr("x", desc_x)                 .attr("y",desc_y + 8*leg_row_height)    .attr("text-anchor", "left")      .style("font-size", "12px")     .text("above the divider line.");    /*    svg    .append("text")    .attr("x", desc_x)                 .attr("y",desc_y + 9*leg_row_height)    .attr("text-anchor", "left")      .style("font-size", "12px")     .text("Hover over the passengers to see the name and age");     */          
   //drow horizontal line     var line_divider = d3.select("svg").append("line")    .attr("x1", x_start1-margin/2)    .attr("y1", y_start)    .attr("x2", x_start3+(shape_size*number_in_a_row)+margin/2)    .attr("y2", y_start)    .attr("stroke-width", 2)    .attr("stroke", "gray");      //debugger;   //draw data from data set   var count = 0;   svg.selectAll("rect")    .data(data)//.sort(function(a,b){return a["Sex"] - b["Sex"];}))//sorting on sex did not work    .enter()    .append("rect")          .attr("x", function(data){             var x = 0;            if(data["Pclass"] == 1){             count = count1;             x = x_start1;                          count1++;            }else if(data["Pclass"] == 2){             count = count2;             x = x_start2;             count2++;            }else{             count = count3;             x = x_start3;             count3++;            }               x = get_x(data,count,x);            return x;  })           .attr("y", function(data){              var rows = 0;            if(data["Pclass"] === 1){                count_y1++;             if(count_y1 > 0 && count_y1%number_in_a_row ==1){              rows1 ++;                     }                rows = rows1;            }else if(data["Pclass"] === 2){             count_y2++;             if(count_y2 > 0 && count_y2%number_in_a_row ==1){              rows2 ++;   }             rows = rows2;            }else{             count_y3++;             if(count_y3 > 0 && count_y3%number_in_a_row ==1){              rows3 ++;   }             rows = rows3;            }               var y = get_y(data,rows);            return y;                          })           .attr("width", function(data){            if(data["Age"] < 18){      return child_shape_size;     }else{      return adult_shape_size;     }})           .attr("height", function(data){            if(data["Age"] < 18){      return child_shape_size;     }else{      return adult_shape_size;     }})           .attr("fill",function(data){             if(data["Sex"]=="male"){          return "darkblue";         }else{          return "maroon";         }})           .attr("id", function(data){ return data["PassengerId"]; })    .attr("Ticket", function(data){return data["Ticket"];})    .attr("Name", function(data){return data["Name"];})    .attr("Age", function(data){return data["Age"];})    .attr("Sex", function(data){return data["Sex"];})    .attr("Survived", function(data){return data["Survived"];});;        //add legend            var leg_female = d3.select("svg")     .append("rect")     .attr("id","female")     .attr("class", "legend")          .attr("width", adult_shape_size)     .attr("height", adult_shape_size)     .attr("x", leg_x)     .attr("y", leg_y)     .attr("opacity", 0.7)     .attr("fill", "maroon");      var text_leg_female = d3.select("svg")     .append("text")     .attr("x", leg_x +30)                  .attr("y",leg_y + 10)     .attr("text-anchor", "left")       .style("font-size", "14px")      .text("Female");
    var leg_male = d3.select("svg")     .append("rect")     .attr("id","male")     .attr("class", "legend")     .attr("width", adult_shape_size)     .attr("height", adult_shape_size)     .attr("x", leg_x)     .attr("y", leg_y + leg_row_height)     .attr("opacity", 0.7)     .attr("fill", "darkblue");      var text_leg_male = d3.select("svg")     .append("text")     .attr("x", leg_x +30)                  .attr("y",leg_y + leg_row_height + 10)     .attr("text-anchor", "left")       .style("font-size", "14px")      .text("Male");         var leg_child = d3.select("svg")     .append("rect")     .attr("id","child")     .attr("class", "legend")     .attr("width", child_shape_size)     .attr("height", child_shape_size)     .attr("x", leg_x +  child_offset)     .attr("y", leg_y + 2*leg_row_height+ child_offset )     .attr("opacity", 0.5)     .attr("fill", "dark gray");
    var text_leg_child = d3.select("svg")     .append("text")     .attr("x", leg_x+30)                  .attr("y",leg_y + 2*leg_row_height+10)     .attr("text-anchor", "left")       .style("font-size", "14px")      .text("younger than 18");               var leg_adult = d3.select("svg")     .append("rect")     .attr("id","adult")     .attr("class", "legend")     .attr("width", adult_shape_size)     .attr("height", adult_shape_size)     .attr("x", leg_x)     .attr("y", leg_y + 3*leg_row_height )     .attr("opacity", 0.5)     .attr("fill", "dark gray");
    var text_label_adult = d3.select("svg")     .append("text")     .attr("x", leg_x+30)                  .attr("y",leg_y + 3*leg_row_height+10)     .attr("text-anchor", "left")       .style("font-size", "14px")      .text("18 and older or unknown");        //add class lables     var y_class = y_start - (rows3+2)*adult_shape_size;     var text_label_class1 = d3.select("svg")     .append("text")          .attr("x", x_start1)                  .attr("y", y_class)     .attr("text-anchor", "left")       .style("font-size", "14px")      .style("font-weight","bold")     .style("text-decoration", "underline")      .text("1st Class");         var text_label_class2 = d3.select("svg")     .append("text")          .attr("x", x_start2)                  .attr("y",y_class)     .attr("text-anchor", "left")       .style("font-size", "14px")      .style("font-weight","bold")     .style("text-decoration", "underline")      .text("2nd Class");         var text_label_class3 = d3.select("svg")     .append("text")          .attr("x", x_start3)                  .attr("y", y_class)     .attr("text-anchor", "left")       .style("font-size", "14px")      .style("font-weight","bold")     .style("text-decoration", "underline")      .text("3rd Class");                   setTimeout(function() { update(svg, data);}, 5000) ;               //window.alert("count1: " + count1+"count2: " + count2+"count3: " + count3);   };
 function update(svg, data){  //debugger;    svg   .append("textarea")    .attr("id", "info")   .attr("x", x_start2)   .attr("y", 50)   .attr("cols", 70)   .attr("rows", 10);  //reset counts  count1 = 0;  count2 = 0;   count3 = 0; //count of passengers by class      count_y1 = 0;      count_y2 = 0;       count_y3 = 0; //count of passengers by class      rows1 = 0;      rows2 = 0;      rows3 = 0;      count1_p = 0;      count2_p = 0;      count3_p = 0; //count of passengers by class      count_y1_p = 0;      count_y2_p = 0;      count_y3_p = 0; //count of perished passengers by class      rows1_p = 0;      rows2_p = 0;      rows3_p = 0;       svg.selectAll("rect").remove();  //remove everything    var h3 = d3.select("h3");        h3.text("Survivors by travel class after the catastrophe");  var h4 = d3.select("h4");        h4.text("Each square represents a passenger. Hover over the passengers to see the name and age.");     //filter data   //move data points with survived 0 below divider line  svg.selectAll("rect")    .data(data)    .enter()    .append("rect")    .attr("x", function(data){       var count = 0;      //window.alert("check " + (data["Pclass"]==1));      if(data["Pclass"] == 1){     if(data["Survived"] == 0){             count = count1_p;      x = x_start1;                   count1_p++;     }else{       count = count1;      x = x_start1;                   count1++;     }    // window.alert("class 1 " + x);      }else if(data["Pclass"] == 2){     if(data["Survived"] == 0){             count = count2_p;      x = x_start2;                   count2_p++;     }else{       count = count2;      x = x_start2;      count2++;     }    // window.alert("class 2 " + x);      }else{     if(data["Survived"] == 0){             count = count3_p;      x = x_start3;                   count3_p++;     }else{       count = count3;      x = x_start3;      count3++;     }     //window.alert("class 3 " + x);      }      //window.alert("before parameters set " + " count " + count + " x: " + x);           x = get_x(data, count, x, true);    return x;     })  .attr("y", function(data){   var rows = 0;    //window.alert("check " + (data["Pclass"]==1));      if(data["Pclass"] == 1){       if(data["Survived"] == 0){             count_y1_p++;             //window.alert("count_y1_p " + count_y1_p + " count_y1_p%number_in_a_row " +count_y1_p%number_in_a_row);       if(count_y1_p > 0 && count_y1_p%number_in_a_row ==1){       rows1_p ++;             }         rows = rows1_p;            }else{       count_y1++;      if(count_y1 > 0 && count_y1%number_in_a_row ==1){       rows1 ++;             }         rows = rows1;     }   //  window.alert("class 1 rows " + rows);     }else if(data["Pclass"] == 2){     if(data["Survived"] == 0){             count_y2_p++;      if(count_y2_p > 0 && count_y2_p%number_in_a_row ==1){       rows2_p ++;             }         rows = rows2_p;     }else{      count_y2++;      if(count_y2 > 0 && count_y2%number_in_a_row ==1){       rows2 ++;   }      rows = rows2;     }   //  window.alert("class 2 " + rows);    }else{     if(data["Survived"] == 0){             count_y3_p++;      if(count_y3_p > 0 && count_y3_p%number_in_a_row ==1){       rows3_p ++;             }         rows = rows3_p;     }else{      count_y3++;      if(count_y3 > 0 && count_y3%number_in_a_row ==1){       rows3 ++;   }      rows = rows3;     }     //window.alert("class 3 " + rows);     }           // window.alert("before parameters set " + " rows " + rows);      y = get_y(data,rows, true);        return y;                 })  .attr("width", function(data){   if(data["Age"] < 18){    return child_shape_size;   }else{    return adult_shape_size;   }})  .attr("height", function(data){   if(data["Age"] < 18){    return child_shape_size;   }else{    return adult_shape_size;   }})  .attr("fill",function(data){    if(data["Sex"]=="male"){    return "darkblue";   }else{    return "maroon";   }})  .attr("opacity", function(data){    if(data["Survived"] == 0){    return 0.7;   }else{    return 1;   }})  .attr("id", function(data){ return data["PassengerId"]; })  .attr("Ticket", function(data){return data["Ticket"];})  .attr("Name", function(data){return data["Name"];})  .attr("Age", function(data){return data["Age"];})  .attr("Sex", function(data){return data["Sex"];})  .attr("Survived", function(data){return data["Survived"];})    .on("mouseenter", function(){   svg.selectAll("rect").attr("opacity",0.1);   d3.select(this).attr("opacity", 1.0);   //keep lables opacity   d3.select("#female").attr("opacity", 1.0);   d3.select("#male").attr("opacity", 1.0);   d3.select("#child").attr("opacity", 0.5);   d3.select("#adult").attr("opacity", 0.5);       })  .on("mouseleave", function(){      svg.selectAll("rect").attr("opacity",function(data){    if(data["Survived"] == 0){      return 0.7;    }else{     return 1;     }});       })  .append("svg:title")     .text(function(data) {       infostr =  data["Name"] +" " + data["Sex"] + " " + data["Age"];      if(data["Survived"]==0){       return infostr + ", Did Not Survive";      }else{       return infostr + ", Survived";      }       });                  //add legend       var leg_female = d3.select("svg")    .append("rect")    .attr("id","female")    .attr("class", "legend")    .attr("width", adult_shape_size)    .attr("height", adult_shape_size)    .attr("x", leg_x)    .attr("y", leg_y)    .attr("opacity", 0.7)    .attr("fill", "maroon");    var text_leg_female = d3.select("svg")    .append("text")    .attr("x", leg_x +30)                 .attr("y",leg_y + 10)    .attr("text-anchor", "left")      .style("font-size", "14px")     .text("Female");
   var leg_male = d3.select("svg")    .append("rect")    .attr("id","male")    .attr("class", "legend")    .attr("width", adult_shape_size)    .attr("height", adult_shape_size)    .attr("x", leg_x)    .attr("y", leg_y + leg_row_height)    .attr("opacity", 0.7)    .attr("fill", "darkblue");    var text_leg_male = d3.select("svg")    .append("text")    .attr("x", leg_x +30)                 .attr("y",leg_y + leg_row_height + 10)    .attr("text-anchor", "left")      .style("font-size", "14px")     .text("Male");       var leg_child = d3.select("svg")    .append("rect")    .attr("id","child")    .attr("class", "legend")    .attr("width", child_shape_size)    .attr("height", child_shape_size)    .attr("x", leg_x +  child_offset)    .attr("y", leg_y + 2*leg_row_height+ child_offset )    .attr("opacity", 0.5)    .attr("fill", "dark gray");
   var text_leg_child = d3.select("svg")    .append("text")    .attr("x", leg_x+30)                 .attr("y",leg_y + 2*leg_row_height+10)    .attr("text-anchor", "left")      .style("font-size", "14px")     .text("younger than 18");          
   var leg_adult = d3.select("svg")    .append("rect")    .attr("id","adult")    .attr("class", "legend")    .attr("width", adult_shape_size)    .attr("height", adult_shape_size)    .attr("x", leg_x)    .attr("y", leg_y + 3*leg_row_height )    .attr("opacity", 0.5)    .attr("fill", "dark gray");
   var text_label_adult = d3.select("svg")    .append("text")    .attr("x", leg_x+30)                 .attr("y",leg_y + 3*leg_row_height+10)    .attr("text-anchor", "left")      .style("font-size", "14px")     .text("18 and older or unknown");      //add class lables    var y_class = y_start - (rows3+3)*adult_shape_size;       var survivied = svg    .append("text")         .attr("x", x_start1-margin)                 .attr("y",y_start-15)    .attr("text-anchor", "left")      .style("font-size", "16px")     .style("font-weight","bold")    .style("text-decoration", "underline")     .text("Survived");        var perished = svg    .append("text")         .attr("x", x_start1-margin)                 .attr("y", y_start + 20)    .attr("text-anchor", "left")      .style("font-size", "16px")     .style("font-weight","bold")    .style("text-decoration", "underline")     .text("Perished");
 };       </script>  </head><body>  <script type="text/javascript">
 d3.csv("titanic_data_sorted.csv", function(d){       d["Survived"] = +d["Survived"];      d["Age"]= +d["Age"];      d["Pclass"] = +d["Pclass"];      return d;      }, draw);         </script><h1>Titanic Data Set Visualization</h1>
<h3>Distribution of passengers by travel class before the catastrophe </h3><h4>(please wait 5 seconds to see how many  passengers survivied) </h4><div id="container" class="svg-container" >
</div></body> 
</html>
